@use '../variables' as *;

// Reusable mixins for overlays
@mixin cell-overlay {
    content: '';
    position: absolute;
    inset: 0;
    pointer-events: none;
}

@mixin interactive-overlay {
    @include cell-overlay;
    pointer-events: auto;
}

// Main cell styles
:host {
    --cell-size: var(--cell-width);
    --cell-pos-x: calc(var(--cell-x, 0) * var(--cell-size));
    --cell-pos-y: calc(var(--cell-y, 0) * var(--cell-size));

    position: absolute;
    left: var(--cell-pos-x);
    top: var(--cell-pos-y);
    width: var(--cell-size);
    height: var(--cell-size);
    display: flex;
    align-items: center;
    justify-content: center;
    box-sizing: border-box;
    box-shadow: $shadow-inner;
    background: $gray-200;
    transform-style: preserve-3d;
    perspective: 30vmin;
}

// Cell types
:host(.floor) {
    background-color: $color-bg-secondary;
    color: $color-text-dim;
}

:host(.path) {
    background-color: $color-path;
    z-index: 10;
}

// Highlight states
:host(.highlight)::after {
    @include interactive-overlay;
    background-color: $color-highlight;
    box-shadow: $shadow-inner-highlight;
    cursor: pointer;
}

:host(.highlight-movement)::after {
    @include interactive-overlay;
    --move-color: 150, 255, 0;
    background-color: rgb(0 255 18 / 25%);
    cursor: pointer;
}

:host(.highlight-intensity)::before {
    @include interactive-overlay;
    --shoot-color: 255, 0, 0;
    --intensity: var(--highlight-intensity, 0.5);
    background-color: rgba(var(--shoot-color), calc(0.6 * var(--intensity)));
    box-shadow: 0 0 calc(15px * var(--intensity)) rgba(var(--shoot-color), calc(var(--intensity) * 0.36)) inset;
    cursor: crosshair;
    transition: background-color $transition-duration-base ease-in-out;
}

:host(.highlight-overwatch)::after {
    @include interactive-overlay;
    --overwatch-color: 0, 100, 255;
    background-color: rgba(var(--overwatch-color), 0.4);
    cursor: crosshair;
}

// Combined states
:host(.highlight-overwatch.highlight-movement)::after {
    @include interactive-overlay;
    background-color: rgb(255 116 0 / 30%);
    cursor: pointer;
}